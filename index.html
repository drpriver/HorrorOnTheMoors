<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Index-Player</title>
<style>
*{
	box-sizing:border-box;
}
a, img {
  -webkit-user-drag: none;
  -khtml-user-drag: none;
  -moz-user-drag: none;
  -o-user-drag: none;
  user-drag: none;
}
html, body {
	height: 100%;
	margin: 0;
	font-family: "Tahoma";
}
body {
	/*background-color: rgb(228,223,204);*/
}
p {
	text-align: justify;
}


h1,h2,h3,h4,h5,h6 {
	font-family: "Tahoma";

}

h3,h4,h5 {
color: rgb(88,24,13);
}
h1, h2, h3 {
	border-bottom: 1px solid #aaaaaa;
	max-width: 50em;
}


a {
    text-decoration: none;
    color: black;
    border-bottom: 1px grey dotted;
}


table {
	border-collapse: collapse;
	margin: 2rem;
	margin-top: 0;
	text-align: left;
	}
th, td {
	padding: .2em 1em;
	border: 1px solid black;
	text-align: left;
	}
table.text_table {
	text-align: left;
}
table.text_table .even {
	background-color: initial;
}
table ul {
	-webkit-margin-before: 0;
	-webkit-margin-after: 0;
}
div.boxed {
	border: 1px solid black;
	max-width: 30em;
	padding: 0 1em;
}

div.horizontal {
	display: flex;
}
.def h3 {
	margin-bottom: 0;
}
.def p{
	padding-left: 1em;
	margin-top: 0;
}

div.map svg {
	background-size: 100% 100%;
}
.hexes svg a text{
	fill: white;
	stroke-width:1px;
	stroke: black;
}
div.grid_container{
	display: grid;
	grid-template-columns: 15% 85%;
	grid-template-rows: 10% 90%;
	grid-column-gap: 4em;
	}

nav {
	font-size: .7em;
	height:100%;
	overflow:auto;
}
.center li {
	text-align: justify;
}

.floater div.map img {
	width:100%;
	max-width: 100%;
}

.left a {
	font-size: 14px;
	display: block;
	border-bottom: none;
}
.left {
	grid-column: 1;
	grid-row: 1;
	position:fixed;
	width: 15%;
	height:100%;
	overflow: scroll;
}
.center {
	padding: 0 10px;
	max-width: 100%;
	grid-column: 2;
	grid-row:1;
	position:fixed;
	overflow: scroll;
	left: calc(15% + 2em);
	padding-bottom: 20em;
	height: 100%;
}
.center p, .center ol, .center ul {
	max-width: 30em;
}
.center p, .center ol, .center ul {
	max-width: 40em;
}

</style>
<script>
"use strict"

function create_floater(){
    let div = document.createElement('div')
    div.className = 'floater'
    let x = 0
    let y = 0
    let mouse_x = -1000
    let mouse_y = -1000
    function mousedown(e){
        const rect = div.getBoundingClientRect()
        x = rect.x
        y = rect.y
        mouse_x = e.clientX
        mouse_y = e.clientY
        div.style.cursor = 'move'
        e.stopPropagation()
    }
    function mousemove(e){
        if(mouse_x != -1000 && mouse_y != -1000){
            let diff_x = e.clientX - mouse_x
            let diff_y = e.clientY - mouse_y
            x = x + diff_x
            y = y + diff_y
            if (x < 0)
                x = 0
            if (y < 0)
                y = 0
            const rect = div.getBoundingClientRect()
            if (x + rect.width > window.innerWidth)
                x = window.innerWidth - rect.width
            if (y + rect.height > window.innerHeight)
                y = window.innerHeight - rect.height
            div.style.left = x + "px"
            div.style.top = y + "px"
            mouse_x = e.clientX
            mouse_y = e.clientY
            e.stopPropagation()
        }
    }
    function mouseup(e){
        if(mouse_x != -1000 && mouse_y != -1000){
            let diff_x = e.clientX - mouse_x
            let diff_y = e.clientY - mouse_y
            div.style.left = x + diff_x + "px"
            div.style.top = y + diff_y + "px"
            mouse_x = -1000
            mouse_y = -1000
            div.style.cursor = 'auto'
            e.stopPropagation()
        }
    }
    div.addEventListener('mousedown', mousedown)
    window.addEventListener('mousemove', mousemove)
    window.addEventListener('mouseup', mouseup)
    let button_container = document.createElement('div')
    button_container.className = 'buttonContainer'
    div.appendChild(button_container)
    let old_width = 0
    function make_button(content, func){
        let button = document.createElement('span')
        button.className = 'button close'
        button.innerHTML = content
        button_container.appendChild(button)
        button.addEventListener('click', func)
    }
    make_button('X', function(){
        document.body.removeChild(div)
        window.removeEventListener('mousemove', mousemove)
        window.removeEventListener('mouseup', mouseup)
    })
    make_button('—', function(){
        const rect = div.getBoundingClientRect()
        if(! old_width)
            old_width = rect.width
        div.style.width = rect.width - 25 + "px"
        div.style.maxWidth = "100%"
    })
    make_button('+', function(){
        const rect = div.getBoundingClientRect()
        if(! old_width)
            old_width = rect.width
        div.style.width = rect.width + 25 + "px"
        div.style.maxWidth = "100%"
    })
    make_button('=', function(){
        if(old_width)
            div.style.width = old_width + "px"
    })
    make_button('M', function(){
        const rect = div.getBoundingClientRect()
        if(! old_width)
            old_width = rect.width
        div.style.width = "100%"
        div.style.maxWidth = "100%"
        div.style.left = "0px"
        div.style.maxHeight = "100%"
    })
    make_button('L', function(){
        const rect = div.getBoundingClientRect()
        if(! old_width)
            old_width = rect.width
        div.style.width = "50%"
        div.style.left = "0px"
        div.style.maxHeight = "100%"
    })
    make_button('R', function(){
        const rect = div.getBoundingClientRect()
        if(! old_width)
            old_width = rect.width
        div.style.width = "50%"
        div.style.left = "50%"
        div.style.maxHeight = "100%"
    })
    make_button('F',function(){
        let old_z = +window.document.defaultView.getComputedStyle(div).getPropertyValue('z-index')
        div.style.zIndex = (old_z+1)+""
    })
    make_button('B', function(){
        let old_z = +window.document.defaultView.getComputedStyle(div).getPropertyValue('z-index')
        div.style.zIndex = (old_z-1)+""
    })
    
    return div
}

function create_object(element, e){
    e.preventDefault()
    const obj = document.createElement('object')
    obj.data = element.href
    obj.width = "100%"
    obj.height = "100%"
    const floater = create_floater()
    floater.appendChild(obj)
    floater.style.height = "80%"
    floater.style.width = "80%"
    document.body.appendChild(floater)
    e.stopPropagation()
}

function linkify(){
    const as = document.getElementsByTagName('a')
    for (let i = 0; i < as.length; i++){
        const a = as[i]
        let is_srd = a.href.includes('d20srd.org')
        let is_monsters = a.href.includes('monsters.html') && a.href.includes('#')
        if (!is_srd && !is_monsters)
                continue
        a.addEventListener('click', create_object.bind({}, a))
    }
}

document.addEventListener("DOMContentLoaded", linkify)


function show_data_element(element, e){
    const text = data_blob[element.innerText]
    let template = document.createElement('template')
    template.innerHTML = text;
    const div = create_floater()
    div.appendChild(template.content.firstChild)
    document.body.appendChild(div)
    e.stopPropagation()
}

</script>
<script>
data_blob={}
</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
</head>
<body>
<div class="grid_container">
<div class="left">
<nav id="TOC">
<ul>
<li><a href="#links">Links</a></li>
</ul>
<hr>
</nav>
</div>
<div class="center">

<h1 id="horror-on-the-moors">Horror on the Moors</h1>
<div>

<div>

<p>
You are in Velyx, a border town on the northern edge of the Karynthian
empire. The Karynthians invaded this area a few hundred years ago, but the
Karynthian empire is in decline. They have withdrawn their armies from this
region, leaving this town and others like it to defend itself. It rains a lot
around Velyx. There’s only two ways to make a living around here now - farm
and rob tombs - and you’ve committed too many felonies to move to more
civilized parts. With no imperial army to enforce the ban on robbing the
ancient tombs of the natives, it’s time to crack open some sealed burial
mounds. What the imperials said about unleashing ancient evils is just
superstition anyway, you need silver to feed your addiction to opium.
</p>
</div>
</div>
<div>
<h2 id="links">Links</h2>
<div>

<ul>
<li> <a href="velyx-player.html#velyx">Velyx</a></li>
<li> <a href="region-player.html#region">Region</a></li>
<li> <a href="religion.html#religion">Religion</a></li>
</ul>
</div>
</div>


</div>
</div>
</body>
</html>
